---
title: 循环神经网络
date: 2024-04-25 09:51:03
permalink: /learn/d2l/471b4f/
categories:
  - 学习笔记
  - 动手深度学习
tags:
  - RNN
---

开始了文本方向的神经网络，之前的卷积看完还是很不知所云的， 对于为什么这样会更好还是只有一个大概的解释，估计文本这方面也不遑多让吧。

<!--more-->

这一节从马可夫链开始，到一个简单的 RNN 实现结束，主要的难点还是在 RNN 实现方面的细节。

## 循环神经网络从零开始实现

### 为什么要对 X 进行转置

首先需要知道的是本节所有的预测都是对<mark>字符</mark>的预测，所以 one_hot 的分类数是 28 。

```python
import torch
from torch.nn import functional as F

X = torch.arange(10).reshape(2, 5)
print(X)
ans = F.one_hot(X, 28)
print(ans)
print(ans.shape)
```

每次做的是对一个批量进行预测，所以每次我们取的是

$$\begin{bmatrix}
0&1\\
1&2\\
2&3\\
\end{bmatrix}$$

